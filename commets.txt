Q - А у нас разве нет там вертики? Не советую просто использовать subprocess в DAG файле
В данном случае, можно использовать vertica_python для установки vertica_python библиотеки, 
либо вручную установить данную библиотеку на машине, где работает Airflow

A - В учебном контейнере который у меня - аирфлоу ругался на отстутствие вертики - поэтому и запихал установку 
vertica_python через subprocess в DAG который нужно запустить 1 раз - чтоб он создал структуру БД и установил нужные библиотеки

----

Q - Если таблицы transactions и currencies уже существуют, то их удаление в этом коде может привести к нежелательным результатам. 
Рекомендую создать функцию, которая проверяет наличие таблицы в БД и удалять ее только в случае ее существования

A - Так в SQL запросе и написано DROP TABLE IF EXISTS - оно удалит таблицу если она существует...
Это специально сделано, потому-что даже если эти таблицы и есть в БД, непонятно какой они структуры,
поэтому что-бы там нибыло, это нужно удалить, и создать с той структурой которая нужна

-----

Q - Давай вынесем все SQL скрипты из дага и будем их вызывать
Также не вижу кода создания проекций

A - SQL вынес отдельную папку, проекций добавил